(function(t){function e(e){for(var i,a,s=e[0],l=e[1],u=e[2],d=0,h=[];d<s.length;d++)a=s[d],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&h.push(r[a][0]),r[a]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);c&&c(e);while(h.length)h.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],i=!0,s=1;s<n.length;s++){var l=n[s];0!==r[l]&&(i=!1)}i&&(o.splice(e--,1),t=a(a.s=n[0]))}return t}var i={},r={app:0},o=[];function a(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=i,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)a.d(n,i,function(e){return t[e]}.bind(null,i));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var u=0;u<s.length;u++)e(s[u]);var c=l;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("cd49")},"0554":function(t,e,n){var i=n("96a4");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var r=n("499e").default;r("17611838",i,!0,{sourceMap:!1,shadowMode:!1})},1441:function(t,e,n){var i=n("fdc2");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var r=n("499e").default;r("b9e0523a",i,!0,{sourceMap:!1,shadowMode:!1})},"5c0b":function(t,e,n){"use strict";var i=n("0554"),r=n.n(i);r.a},"96a4":function(t,e,n){var i=n("24fb");e=i(!1),e.push([t.i,"body,html{padding:0;margin:0;height:100vh;background:#2c3e50}#app{color:#2c3e50;max-width:800px;margin:0 auto;-webkit-font-smoothing:subpixel-antialiased}#app .video-player{display:block;margin:0 auto}#app .el-slider{width:150px}#app .title{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}#app .title,#app .title .left{display:-webkit-box;display:-ms-flexbox;display:flex}#app .title .left img{height:50px}#app .title .left .text{display:inline-block;margin-left:20px;font-size:40px;font-weight:100;line-height:50px}#app .title .right{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}#app .title .right .el-link+.el-link{margin-left:20px}.extra-button{font-size:1.5rem}.debug-info{position:fixed;right:0;bottom:0;padding:4px;background:#e7e7e7;overflow:auto;max-width:100vw;z-index:999}",""]),t.exports=e},cd49:function(t,e,n){"use strict";n.r(e);var i=n("2b0e"),r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-card",{attrs:{id:"app"}},[i("div",{staticClass:"title",attrs:{slot:"header"},slot:"header"},[i("div",{staticClass:"left"},[i("img",{attrs:{src:n("cf05"),title:"logo",alt:"logo"}}),i("div",{staticClass:"text"},[t._v("DanPlayer v0.0.37")])]),i("div",{staticClass:"right"},[i("el-link",{attrs:{type:"primary",href:"https://github.com/gzlock/danplayer",target:"_blank"}},[t._v("Github")]),i("el-link",{attrs:{href:"https://github.com/gzlock/danplayer/blob/master/src/App.vue",target:"_blank"}},[t._v("本页代码 ")])],1)]),i("div",{attrs:{id:"player"}}),i("h3",[t._v("功能调试区域")]),i("el-tabs",{attrs:{value:"player"}},[i("el-tab-pane",{attrs:{label:"播放器相关",name:"player"}},[i("el-form",{attrs:{size:"mini","label-width":"140px"}},[i("el-form-item",{attrs:{label:"Player Language"}},[i("el-radio-group",{model:{value:t.settings.isChinese,callback:function(e){t.$set(t.settings,"isChinese",e)},expression:"settings.isChinese"}},[i("el-radio-button",{attrs:{label:!0}},[t._v("中文")]),i("el-radio-button",{attrs:{label:!1}},[t._v("English")])],1)],1),i("el-form-item",{attrs:{label:"播放器形态"}},[i("el-radio-group",{model:{value:t.settings.live,callback:function(e){t.$set(t.settings,"live",e)},expression:"settings.live"}},[i("el-radio-button",{attrs:{label:!1}},[t._v("普通视频")]),i("el-radio-button",{attrs:{label:!0}},[t._v("直播")])],1)],1),i("el-form-item",{attrs:{label:"全屏功能"}},[i("el-radio-group",{model:{value:t.settings.fullscreen,callback:function(e){t.$set(t.settings,"fullscreen",e)},expression:"settings.fullscreen"}},[i("el-radio-button",{attrs:{label:!0}},[t._v("允许")]),i("el-radio-button",{attrs:{label:!1}},[t._v("不允许")])],1)],1),i("el-form-item",{attrs:{label:"控制栏发弹幕功能"}},[i("el-radio-group",{model:{value:t.settings.danmakuForm,callback:function(e){t.$set(t.settings,"danmakuForm",e)},expression:"settings.danmakuForm"}},[i("el-radio-button",{attrs:{label:!0}},[t._v("开启")]),i("el-radio-button",{attrs:{label:!1}},[t._v("关闭")])],1),i("div",[t._v(" 关闭发弹幕的功能区域后，如果仍然需要支持观众发弹幕，则需要自行实行相关的功能 ")])],1),i("el-form-item",{attrs:{label:"音量"}},[i("div",[t._v(" 范围 0~1 ")]),i("el-slider",{attrs:{min:0,max:1,step:.1},model:{value:t.settings.volume,callback:function(e){t.$set(t.settings,"volume",e)},expression:"settings.volume"}})],1),i("el-form-item",{attrs:{label:"颜色"}},[i("el-color-picker",{model:{value:t.settings.color,callback:function(e){t.$set(t.settings,"color",e)},expression:"settings.color"}}),i("div",[t._v("视频进度条滑块，音量滑块，设置选项的高亮颜色")])],1),i("el-form-item",{attrs:{label:"视频网址"}},[i("div",[i("el-button",{on:{click:t.playMp4}},[t._v("播放Mp4视频资源(浏览器原生支持)")])],1),i("div",[i("el-button",{on:{click:t.playHls}},[t._v("播放Hls视频资源(使用hls.js)")])],1),i("div",[i("el-button",{on:{click:t.playMpd}},[t._v("播放MPD视频资源(使用dash.js)")])],1),i("br"),i("el-input",{attrs:{placeholder:"输入网址"},model:{value:t.form.videoSrc,callback:function(e){t.$set(t.form,"videoSrc",e)},expression:"form.videoSrc"}}),i("el-button",{on:{click:t.setSrc}},[t._v("播放器自定义资源")])],1)],1)],1),i("el-tab-pane",{attrs:{label:"弹幕相关",name:"danmaku_layer"}},[i("el-form",{attrs:{size:"mini","label-width":"140px"}},[i("el-form-item",{attrs:{label:"弹幕"}},[i("el-radio-group",{model:{value:t.settings.danmaku,callback:function(e){t.$set(t.settings,"danmaku",e)},expression:"settings.danmaku"}},[i("el-radio-button",{attrs:{label:!0}},[t._v("启用")]),i("el-radio-button",{attrs:{label:!1}},[t._v("禁用")])],1),i("div",[t._v("提示：弹幕的逻辑还是在运作的，只是不渲染弹幕")])],1),i("el-form-item",{attrs:{label:"弹幕显示"}},[i("el-radio-group",{model:{value:t.settings.danmakuLimit,callback:function(e){t.$set(t.settings,"danmakuLimit",e)},expression:"settings.danmakuLimit"}},[i("el-radio-button",{attrs:{label:"UnLimited"}},[t._v("不作限制")]),i("el-radio-button",{attrs:{label:"UnOverlap"}},[t._v("防止重叠")]),i("el-radio-button",{attrs:{label:"Percent25"}},[t._v("25%屏幕显示")]),i("el-radio-button",{attrs:{label:"Half"}},[t._v("50%屏幕显示")]),i("el-radio-button",{attrs:{label:"Percent75"}},[t._v("75%屏幕显示")])],1)],1),i("el-form-item",{attrs:{label:"流动式弹幕的时间"}},[i("div",[t._v("以秒单位，值越大速度越慢："+t._s(t.settings.flowDuration)+"秒")]),i("div",[t._v("从右到左在屏幕的逗留时间，所以时间越小，弹幕的速度越快")]),i("el-slider",{attrs:{min:1,max:20},model:{value:t.settings.flowDuration,callback:function(e){t.$set(t.settings,"flowDuration",e)},expression:"settings.flowDuration"}})],1),i("el-form-item",{attrs:{label:"固定式弹幕的时间"}},[i("div",[t._v("以秒单位："+t._s(t.settings.fadeoutDuration)+"秒")]),i("el-slider",{attrs:{min:1,max:20},model:{value:t.settings.fadeoutDuration,callback:function(e){t.$set(t.settings,"fadeoutDuration",e)},expression:"settings.fadeoutDuration"}})],1),i("el-form-item",{attrs:{label:"弹幕透明度"}},[i("div",[t._v("范围在 0 ~ 1："+t._s(t.settings.alpha))]),i("el-slider",{attrs:{min:.1,max:1,step:.1},model:{value:t.settings.alpha,callback:function(e){t.$set(t.settings,"alpha",e)},expression:"settings.alpha"}})],1),i("el-form-item",{attrs:{label:"发弹幕"}},[i("el-radio-group",{ref:"danmaku-type",model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[i("el-radio-button",{attrs:{label:0}},[t._v("顶部")]),i("el-radio-button",{attrs:{label:1}},[t._v("流动")]),i("el-radio-button",{attrs:{label:2}},[t._v("底部")])],1),i("el-input",{attrs:{placeholder:"回车发送"},on:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.sendDanmaku(e)}},model:{value:t.form.danmaku,callback:function(e){t.$set(t.form,"danmaku",e)},expression:"form.danmaku"}},[i("el-button",{attrs:{slot:"append",type:"primary"},on:{click:t.sendDanmaku},slot:"append"},[t._v("发送")])],1)],1),i("el-form-item",{attrs:{label:"发随机弹幕"}},[i("div",{staticStyle:{width:"200px"}},[i("el-input",{model:{value:t.random.timeRange,callback:function(e){t.$set(t.random,"timeRange",e)},expression:"random.timeRange"}},[i("span",{attrs:{slot:"append"},slot:"append"},[t._v("秒内")])]),i("el-input",{model:{value:t.random.count,callback:function(e){t.$set(t.random,"count",e)},expression:"random.count"}},[i("span",{attrs:{slot:"append"},slot:"append"},[t._v("条弹幕")])])],1),i("el-button",{attrs:{type:"primary"},on:{click:t.sendRandomDanmaku}},[t._v("填充弹幕")])],1)],1)],1),i("el-tab-pane",{attrs:{label:"事件相关",name:"player_event"}},[i("p",[t._v("DanPlayer暴露了video元素(player.$video)，所以涉及到原生的视频事件需求，大家可以继续绑定到player.$video"),i("br"),t._v("例如：播放进度、音量的变化。")]),i("p",[t._v('由于"弹幕发送前"事件较为特殊，因此设置在player的参数里，请看代码：')]),i("pre",[t._v("async function beforeSendDanmaku(danmaku){\n  return true 通知player可以将这次发送的弹幕显示到屏幕上\n  return false 通知player不要将这次发送的弹幕显示到屏幕上\n}\nnew danmaku.Player({beforeSendDanmaku})\nplayer.set({beforeSendDanmaku})\n          ")]),i("div",[t._v("DanPlayer支持的事件： "),i("ul",[i("li",[t._v("使用player.on('事件名称',player=>void)绑定事件")]),i("li",[t._v("optionChanged：当player的options即设置改变时触发，传入当前的player实例。")]),i("li",[t._v("toggleFullscreen：当player切换全屏状态时触发，并传入当前的player实例"),i("br"),t._v("可以使用player.isFullScreen查询是否处于全屏状态。 ")])])])])],1)],1),i("div",{staticClass:"debug-info"},[i("div",[i("el-checkbox",{model:{value:t.debug,callback:function(e){t.debug=e},expression:"debug"}},[t._v("Debug信息")])],1),i("pre")])],1)},o=[],a=n("a34a"),s=n.n(a),l=n("9ab4"),u=n("60a3"),c=(n("1441"),n("ba10")),d=n("5fe9"),h=n.n(d);function p(t){return p="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function v(t,e,n){return e&&y(t.prototype,e),n&&y(t,n),t}function m(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&b(t,e)}function b(t,e){return b=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},b(t,e)}function g(t){var e=x();return function(){var n,i=$(t);if(e){var r=$(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return k(this,n)}}function k(t,e){return!e||"object"!==p(e)&&"function"!==typeof e?w(t):e}function w(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function x(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function $(t){return $=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},$(t)}var S=function(t){m(n,t);var e=g(n);function n(t){var i;return f(this,n),i=e.call(this),i.layerHideDelay=200,i.bottomOffset=40,i.hideTimeout=-1,i._isShow=!1,i.ui=t,i.player=t.player,i}return v(n,[{key:"init",value:function(){var t=this,e=function(){clearTimeout(t.hideTimeout),t.ui.isMouseInUI=!0,t.showLayer()},n=function(){t.ui.isMouseInUI=!1,clearTimeout(t.hideTimeout),t.hideTimeout=setTimeout((function(){t.hideLayer()}),t.layerHideDelay)};this.$btn.addEventListener("mouseenter",e),this.$btn.addEventListener("mouseleave",n),this.$layer.addEventListener("mouseenter",e),this.$layer.addEventListener("mouseleave",n)}},{key:"showLayer",value:function(){this._isShow=!0,this.$layer.classList.add("show"),this.updateLayerPosition()}},{key:"hideLayer",value:function(){this._isShow=!1,this.$layer.classList.remove("show")}},{key:"toggleLayer",value:function(){this._isShow?this.hideLayer():this.showLayer()}},{key:"showButton",value:function(){this.$btn.style.display=""}},{key:"hideButton",value:function(){this.$btn.style.display="none"}},{key:"updateLayerPosition",value:function(){if(this._isShow){var t=this.ui.player.$root.getBoundingClientRect(),e=this.$btn.getBoundingClientRect(),n=this.$layer.getBoundingClientRect(),i=e.left+e.width/2-t.left-n.width/2;this.$layer.style.left=i+"px",this.$layer.style.bottom=this.bottomOffset+"px"}}},{key:"destroy",value:function(){clearTimeout(this.hideTimeout)}},{key:"isShow",get:function(){return this._isShow}}]),n}(c["EventEmitter"]);function L(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function E(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function O(t,e,n){return e&&E(t.prototype,e),n&&E(t,n),t}var D=function(){function t(e){L(this,t),this.$root=e,this.$use=this.$root.querySelector("use")}return O(t,[{key:"switch",value:function(t,e){this.switchIcon(t),e&&this.switchTitle(e)}},{key:"switchIcon",value:function(t){this.$use.setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.$root.getAttribute(t))}},{key:"switchTitle",value:function(t){this.$root.setAttribute("title",this.$root.getAttribute(t))}},{key:"show",value:function(){this.$root.classList.remove("hide")}},{key:"hide",value:function(){this.$root.classList.add("hide")}}]),t}();function P(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function T(t,e,n){return e&&_(t.prototype,e),n&&_(t,n),t}var j=function(){function t(e){P(this,t),this.isShow=!1,this.$root=document.createElement("div"),this.$root.classList.add("toast"),e.$root.append(this.$root)}return T(t,[{key:"show",value:function(){this.isShow=!0,this.$root.classList.add("show")}},{key:"hide",value:function(){this.isShow=!1,this.$root.classList.remove("show")}},{key:"width",get:function(){return this.$root.clientWidth}},{key:"height",get:function(){return this.$root.clientHeight}},{key:"text",set:function(t){this.$root.innerText=t},get:function(){return this.$root.innerText}},{key:"x",get:function(){return parseInt(this.$root.style.left||"0")},set:function(t){this.$root.style.left=t+"px"}},{key:"y",get:function(){return parseInt(this.$root.style.top||"0")},set:function(t){this.$root.style.top=t+"px"}}]),t}();function B(t){return B="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B(t)}function F(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function I(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function A(t,e,n){return e&&I(t.prototype,e),n&&I(t,n),t}function C(t,e,n){return C="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=R(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}},C(t,e,n||t)}function R(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=W(t),null===t)break;return t}function q(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&z(t,e)}function z(t,e){return z=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},z(t,e)}function M(t){var e=Y();return function(){var n,i=W(t);if(e){var r=W(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return H(this,n)}}function H(t,e){return!e||"object"!==B(e)&&"function"!==typeof e?U(t):e}function U(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Y(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function W(t){return W=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},W(t)}h.a.enableBoundaryChecking(!1);var N=function(t){q(n,t);var e=M(n);function n(t){var i;F(this,n),i=e.call(this,t),i.volumeValue=0,i.areaHeight=0,i.hideToast=-1,i.$video=i.player.$video,i.toast=new j(t),i.$video.addEventListener("volumechange",(function(){return i.updateController()})),i.$layer=i.player.$root.querySelector(".interactive-layer .volume-bar"),i.$valueLabel=i.$layer.querySelector(".volume-num-label"),i.$btn=i.player.$root.querySelector(".interactive-layer .buttons .button.volume"),i.btn=new D(i.$btn),i.$btn.addEventListener("click",(function(){return i.toggleMuted()})),i.$dragArea=i.$layer.querySelector(".volume-column-bar"),i.$controller=i.$dragArea.querySelector(".bar-controller"),i.$current=i.$dragArea.querySelector(".bar-current"),i.volumeValue=i.$video.volume=i.player.options.volume,0===i.volumeValue&&(i.volumeValue=.7);var r=function(t){var e=t.pageY,n=i.$dragArea.getBoundingClientRect();if(e<n.top)i.$video.volume=1;else if(e>n.bottom)i.$video.volume=0;else{var r=n.bottom-n.top;e-=n.top;var o=e/r;i.$video.volume=h.a.round(1-o,2)}i.volumeValue=i.$video.volume,i.updateController()},o=function t(e){document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",t),r(e)};return i.$dragArea.addEventListener("mousedown",(function(){document.addEventListener("mousemove",r),document.addEventListener("mouseup",o)})),i.init(),i.updateController(),i}return A(n,[{key:"up",value:function(){this.$video.volume<=.9?this.$video.volume=h.a.plus(this.$video.volume,.1):this.$video.volume=1,this.volumeValue=this.$video.volume,this.showToast()}},{key:"down",value:function(){this.$video.volume>=.1?this.$video.volume=h.a.minus(this.$video.volume,.1):this.$video.volume=0,this.volumeValue=this.$video.volume,this.showToast()}},{key:"showToast",value:function(){var t=this;this.isShow||(this.toast.show(),this.toast.text=this.ui.string.volume+"："+h.a.round(100*this.$video.volume,0),clearTimeout(this.hideToast),this.hideToast=setTimeout((function(){t.toast.hide()}),2e3),this.updateToastPosition())}},{key:"updateToastPosition",value:function(){this.toast.x=(this.player.width-this.toast.width)/2,this.toast.y=(this.player.height-this.toast.height)/2}},{key:"toggleMuted",value:function(){this.$video.volume>0?this.$video.volume=0:0===this.volumeValue?this.$video.volume=1:this.$video.volume=this.volumeValue,this.updateButton()}},{key:"updateButton",value:function(){var t;t=this.$video.volume>0?"data-on":"data-off",this.btn.switch(t)}},{key:"updateController",value:function(){var t=h.a.round(100*this.$video.volume,0);this.$valueLabel.innerText=t.toString();var e=this.$video.volume*this.areaHeight;this.$current.style.height=e+"px",e=this.areaHeight-e,this.$controller.style.transform="translateY(".concat(e,"px)"),this.updateButton()}},{key:"showLayer",value:function(){C(W(n.prototype),"showLayer",this).call(this),this.areaHeight=this.$dragArea.clientHeight,this.updateController()}},{key:"update",value:function(){this.btn.$root.setAttribute("title",this.ui.string.volume),this.toast.isShow&&this.updateToastPosition(),this.isShow&&this.updateLayerPosition()}}]),n}(S);function V(t){return V="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V(t)}function Q(t){return Z(t)||J(t)||X(t)||G()}function G(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function X(t,e){if(t){if("string"===typeof t)return K(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?K(t,e):void 0}}function J(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function Z(t){if(Array.isArray(t))return K(t)}function K(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function tt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function et(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function nt(t,e,n){return e&&et(t.prototype,e),n&&et(t,n),t}function it(t,e,n){return it="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=rt(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}},it(t,e,n||t)}function rt(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=dt(t),null===t)break;return t}function ot(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&at(t,e)}function at(t,e){return at=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},at(t,e)}function st(t){var e=ct();return function(){var n,i=dt(t);if(e){var r=dt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return lt(this,n)}}function lt(t,e){return!e||"object"!==V(e)&&"function"!==typeof e?ut(t):e}function ut(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ct(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function dt(t){return dt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},dt(t)}var ht=function(t){ot(n,t);var e=st(n);function n(t){var i;return tt(this,n),i=e.call(this,t),i.levels=[],i.currentLevel=-1,i.autoLevel={selected:!1,name:t.string.autoQualitySelect,index:-1,bitrate:0},i.$btn=i.player.$root.querySelector(".button.quality"),i.$layer=i.player.$root.querySelector(".float.quality-menu"),i.init(),i.$layer.addEventListener(i.player.clickEvent,(function(t){var e=t.target;if(e.hasAttribute("data-value")){var n=parseInt(e.getAttribute("data-value"));i.levels.forEach((function(t){t.selected&&t.index===i.currentLevel||(t.selected=t.index===n,t.selected&&(i.emit("selectLevel",t),i.currentLevel=n))})),i.updateButton(),i.hideLayer()}})),i}return nt(n,[{key:"showLayer",value:function(){it(dt(n.prototype),"showLayer",this).call(this),this.updateLevelMenu(),this.updateLayerPosition(),this.updateButton()}},{key:"updateButton",value:function(){var t=this;this.levels.every((function(e){return e.selected&&(t.$btn.innerText=e.name),!e.selected}))}},{key:"reset",value:function(){this.levels.length=0,this.currentLevel=-1,this.$layer.innerHTML=""}},{key:"updateLevelMenu",value:function(){var t=this;this.$layer.innerHTML="",this.levels.forEach((function(e){var n=document.createElement("div");e.index===t.currentLevel&&n.classList.add("current"),n.innerText=e.name,n.setAttribute("data-value",e.index.toString()),t.$layer.append(n)}))}},{key:"updateLevel",value:function(t){var e,n=this;this.levels.length=0,(e=this.levels).push.apply(e,Q(t.reverse()).concat([this.autoLevel])),-1===this.currentLevel?this.autoLevel.selected=!0:this.levels.every((function(t){t.selected=t.index===n.currentLevel})),this.updateLevelMenu(),this.updateLayerPosition(),this.updateButton()}},{key:"update",value:function(){this.$btn.style.display=this.player.type===fn.Normal?"none":"",this.autoLevel.name=this.ui.string.autoQualitySelect,this.updateLevelMenu(),this.updateButton()}}]),n}(S);function pt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"hh:mm:ss";t=parseInt(t.toString(),10);var n=0,i=0,r=0;return t>0&&(e.indexOf("h")>-1&&(n=Math.floor(t/3600)),e.indexOf("m")>-1&&(i=Math.floor((t-3600*n)/60)),r=t-3600*n-60*i),e=e.split("hh").join(n.toString().padStart(2,"0")).split("h").join(n.toString()).split("mm").join(i.toString().padStart(2,"0")).split("m").join(i.toString()).split("ss").join(r.toString().padStart(2,"0")).split("s").join(r.toString()),e}function ft(t){var e,n,i=0;if(0===t.length)return i;for(e=0;e<t.length;e++)n=t.charCodeAt(e),i=(i<<5)-i+n,i|=0;return i}function yt(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6,e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",n="",i=0;i<t;i++)n+=e.charAt(Math.floor(Math.random()*e.length));return n}function vt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function bt(t,e,n){return e&&mt(t.prototype,e),n&&mt(t,n),t}var gt,kt=function(){function t(e){var n=this;vt(this,t),this.barWidth=0,this._currentTime=0,this.percent=0,this.offsetWidth=0,this.isDragging=!1,this.player=e.player,this.ui=e,this.toast=new j(e),this.$root=this.player.$root.querySelector(".progress-bar"),this.$controller=this.$root.querySelector(".bar-controller"),this.$current=this.$root.querySelector(".bar-current"),this.$time=this.player.$root.querySelector(".controller-bottom-bar .time"),this.$buffer=this.$root.querySelector(".bar-buffer"),this.player.$video.addEventListener("timeupdate",(function(){n._currentTime=n.player.$video.currentTime,n.isDragging||(n.percent=n._currentTime/n.player.$video.duration,isNaN(n.percent)&&(n.percent=0),n.updateTime(),n.updateBar())})),this.player.$video.addEventListener("progress",(function(){n.updateTime(),n.updateBufferBar()})),this.resize(),this.initEventAboutController(),this.initEventAboutToast(),this.updateTime()}return bt(t,[{key:"initEventAboutController",value:function(){var t=this,e=function(e){var n=t.$root.getBoundingClientRect(),i=e.clientX-n.left;t.percent=i/t.barWidth,(isNaN(t.percent)||t.percent<0)&&(t.percent=0),t.percent>1&&(t.percent=1),t.update(),t.ui.isMouseInUI=!0},n=function n(){document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",n),t.isDragging=!1,t.player.$video.currentTime=t.percent*t.player.$video.duration};this.$root.addEventListener("mousedown",(function(){t.isDragging=!0,document.addEventListener("mousemove",e),document.addEventListener("mouseup",n)})),this.$root.addEventListener("click",(function(n){e(n),t.player.$video.currentTime=t.percent*t.player.$video.duration}))}},{key:"initEventAboutToast",value:function(){var t=this,e=!1,n=!1,i=function t(){document.removeEventListener("mouseup",t),n=!1,r()},r=function(){e||n||(t.toast.hide(),document.removeEventListener("mousemove",o))},o=function(e){var n=t.player.$root.getBoundingClientRect(),i=t.$root.getBoundingClientRect(),r=e.clientX-i.left;t.ui.isShow||(r-=t.offsetWidth/2);var o=r/t.barWidth;(isNaN(o)||o<0)&&(t.percent=0),t.percent>1&&(t.percent=1),t.toast.text=pt(o*t.player.$video.duration),r<0?r=0:r+t.toast.width>t.player.width&&(r=t.player.width-t.toast.width),t.toast.x=r,t.toast.y=i.top-n.top-50};this.$root.addEventListener("mousedown",(function(){t.toast.show(),n=!0,document.addEventListener("mouseup",i),document.addEventListener("mousemove",o)})),this.$root.addEventListener("mouseenter",(function(){t.toast.show(),e=!0,document.addEventListener("mousemove",o)})),this.$root.addEventListener("mouseleave",(function(){e=!1,r()}))}},{key:"updateTime",value:function(){this.player.options.live||(this.$time.innerText=pt(this.player.$video.currentTime,this.player.options.timeFormat)+" / "+pt(this.player.$video.duration,this.player.options.timeFormat))}},{key:"init",value:function(){this.offsetWidth=this.player.width-this.$root.offsetWidth}},{key:"resize",value:function(){this.barWidth=this.player.width-this.offsetWidth,this.updateBar(),this.updateBufferBar()}},{key:"update",value:function(){this.player.options.live&&(this.$time.innerText=this.ui.string.live)}},{key:"reset",value:function(){this.resetTimeZone(),this.resetProgressBar()}},{key:"updateBar",value:function(){this.ui.isShow?this.barWidth=this.player.width-this.offsetWidth:this.barWidth=this.player.width;var t=this.barWidth*this.percent;this.$current.style.width=t+"px",this.$controller.style.transform="translateX(".concat(t,"px)")}},{key:"resetTimeZone",value:function(){this.player.options.live?this.$time.innerText="直播":this.$time.innerText=pt(0)+" / "+pt(0)}},{key:"resetProgressBar",value:function(){this.percent=0,this.$buffer.style.width="0px",this.update()}},{key:"updateBufferBar",value:function(){for(var t=0;t<this.player.$video.buffered.length;t++){this.player.$video.buffered.start(t);var e=this.player.$video.buffered.end(t);this.$buffer.style.width=e/this.player.$video.duration*this.barWidth+"px"}}}]),t}();function wt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xt(t){var e=t.currentTime,n=void 0===e?0:e,i=t.borderColor,r=void 0===i?"":i,o=t.fill,a=void 0===o?"#ffffff":o,s=t.type,l=void 0===s?gt.Flow:s,u=t.id,c=void 0===u?"":u,d=t.fontSize,h=void 0===d?28:d;return{currentTime:n,type:l,borderColor:r,fill:a,id:c,fontSize:h}}(function(t){t[t["Top"]=0]="Top",t[t["Flow"]=1]="Flow",t[t["Bottom"]=2]="Bottom"})(gt||(gt={}));var $t=function t(e,n){wt(this,t),this.text=e,Object.assign(this,xt(n||{}))};function St(t){return St="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},St(t)}function Lt(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Et(t,e)}function Et(t,e){return Et=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Et(t,e)}function Ot(t){var e=_t();return function(){var n,i=Tt(t);if(e){var r=Tt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Dt(this,n)}}function Dt(t,e){return!e||"object"!==St(e)&&"function"!==typeof e?Pt(t):e}function Pt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _t(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Tt(t){return Tt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Tt(t)}function jt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Bt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ft(t,e,n){return e&&Bt(t.prototype,e),n&&Bt(t,n),t}var It='px "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif',At=function(){function t(){jt(this,t),this.top=0,this.left=0,this.width=0,this.height=0,this.enable=!1,this.selfCanvas=document.createElement("canvas"),this.selfCanvas.width=100,this.selfCanvas.height=100,this.ctx=this.selfCanvas.getContext("2d")}return Ft(t,[{key:"getSize",value:function(){this.ctx.textBaseline="top",this.ctx.textAlign="left",this.ctx.font=this.danmaku.fontSize+It,this.width=Math.round(this.ctx.measureText(this.danmaku.text).width),this.height=Math.round(1.2*this.ctx.measureText("M").width)}},{key:"draw",value:function(){var t=this.width+4,e=this.height;this.selfCanvas.width=t,this.selfCanvas.height=e,this.ctx.textBaseline="top",this.ctx.textAlign="left",this.ctx.font=this.danmaku.fontSize+It,this.ctx.clearRect(0,0,t,e),this.danmaku.borderColor&&(this.ctx.lineWidth=1,this.ctx.strokeStyle=this.danmaku.borderColor,this.ctx.strokeRect(1,1,t-4,e-4)),this.ctx.shadowBlur=2,this.ctx.shadowColor="black",this.ctx.fillStyle=this.danmaku.fill,this.ctx.fillText(this.danmaku.text,1,1)}}]),t}(),Ct=function(t){Lt(n,t);var e=Ot(n);function n(){return jt(this,n),e.apply(this,arguments)}return Ft(n,[{key:"set",value:function(t,e,n){this.danmaku=t,this.enable=!0,this.left=e,this.top=n,this.getSize(),this.draw()}},{key:"update",value:function(t,e,n){var i=(t+this.width)/e*n;this.left=this.left-i,this.enable=this.left+this.width>0}}]),n}(At),Rt=function(t){Lt(n,t);var e=Ot(n);function n(){var t;return jt(this,n),t=e.apply(this,arguments),t.timeout=0,t}return Ft(n,[{key:"set",value:function(t,e,n,i){this.danmaku=t,this.timeout=e,this.enable=!0,this.getSize(),this.left=(n-this.width)/2,this.top=i,this.draw(),this.update(0)}},{key:"update",value:function(t){this.timeout-=t,this.enable=this.timeout>0}}]),n}(At),qt=n("faa1");function zt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Mt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ht(t,e,n){return e&&Mt(t.prototype,e),n&&Mt(t,n),t}var Ut,Yt='px "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif',Wt=function(){function t(e){var n=this;zt(this,t),this.caches=[],this.player=e,this.$canvas=e.$root.querySelector("canvas"),this.ctx=this.$canvas.getContext("2d"),this.$canvas.addEventListener(e.clickEvent,(function(){n.player.ui.isShow&&e.toggle()}))}return Ht(t,[{key:"addDrawer",value:function(t){this.caches.push(t)}},{key:"removeDrawer",value:function(t){var e=this.caches.indexOf(t);e>-1&&this.caches.splice(e,1)}},{key:"clear",value:function(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)}},{key:"renderAll",value:function(){if(this.caches.length>0)for(var t=0;t<this.caches.length;t++){var e=this.caches[t];this.ctx.drawImage(e.selfCanvas,e.left,e.top)}}},{key:"clearCache",value:function(){this.caches.length=0}},{key:"fontHeight",value:function(t){this.ctx.font=t+Yt;var e=this.ctx.measureText("M");return 1.2*e.width}},{key:"resize",value:function(){this.$canvas.setAttribute("width",this.player.width+"px"),this.$canvas.setAttribute("height",this.player.height+"px")}},{key:"alpha",set:function(t){this.ctx.globalAlpha=t},get:function(){return this.ctx.globalAlpha}}]),t}();function Nt(t){return Xt(t)||Gt(t)||Qt(t)||Vt()}function Vt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Qt(t,e){if(t){if("string"===typeof t)return Jt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jt(t,e):void 0}}function Gt(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function Xt(t){if(Array.isArray(t))return Jt(t)}function Jt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Zt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Kt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function te(t,e,n){return e&&Kt(t.prototype,e),n&&Kt(t,n),t}function ee(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.alpha,n=void 0===e?1:e,i=t.enable,r=void 0===i||i,o=t.flowDuration,a=void 0===o?8:o,s=t.fadeoutDuration,l=void 0===s?5:s,u=t.fontSize,c=void 0===u?28:u,d=t.limit,h=void 0===d?Ut.UnOverlap:d,p=t.contextMenu,f=void 0===p?void 0:p;return{alpha:n,enable:r,flowDuration:a,fontSize:c,limit:h,fadeoutDuration:l,contextMenu:f}}(function(t){t["UnLimited"]="unLimited",t["UnOverlap"]="unOverlap",t["Percent25"]="percent25",t["Half"]="half",t["Percent75"]="percent75"})(Ut||(Ut={}));var ne='<div class="content"></div><div class="buttons"></div>';function ie(t,e){var n=document.createElement("div");n.innerHTML=ne;var i=n.querySelector(".content");i.innerText=t.danmaku.text;var r=n.querySelector(".buttons");for(var o in e){var a=document.createElement("span");a.innerText=o,a.addEventListener("click",e[o]),r.prepend(a)}return n}function re(t){var e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}var oe=function(){function t(e){var n=this;Zt(this,t),this.danmakus=[],this.showed=[],this.topEnables=[],this.topAndBottomDisables=[],this.bottomEnables=[],this.flowEnables=[],this.flowDisables=[],this.lineHeights=[],this.topLines={},this.bottomLines={},this.flowLines={},this.displayArea=0,this.topLineIndex=0,this.flowY=0,this.bottomY=0,this.frameTime=0,this.updateDanmakuTime=0,this.isShow=!0,this.width=0,this.height=0,this.calcTopInterval=-1,this.destroied=!1,this.addDanmakuToCanvasTime=0,this.lastFrame=0,window.danmaku=this,this.player=e,this.event=new qt["EventEmitter"],this.canvas=new Wt(e);var i=function t(){document.removeEventListener("click",t),document.removeEventListener("contextmenu",t),n.$menu.remove()};this.canvas.$canvas.addEventListener("contextmenu",(function(t){var e=n.findDrawers(t);if(e.length>0){n.createDanmakuMenu(e);var r=t.pageX,o=t.pageY,a=t.clientX+n.$menu.clientWidth,s=t.clientY+n.$menu.clientHeight;a>document.body.clientWidth&&(r-=a-document.body.clientWidth),s>document.body.clientHeight&&(o-=s-document.body.clientHeight),n.$menu.style.left=r+"px",n.$menu.style.top=o+"px",document.addEventListener("click",i),document.addEventListener("touchstart",i),document.addEventListener("contextmenu",i)}t.preventDefault(),t.stopPropagation()})),this.canvas.$canvas.addEventListener("dblclick",(function(){n.player.toggleFullScreen()})),this.player.$video.addEventListener("seeked",(function(){n.clear()})),this.loop()}return te(t,[{key:"createDanmakuMenu",value:function(t){var e=this;this.$menu&&this.$menu.remove(),this.$menu=document.createElement("div"),this.$menu.classList.add("danplayer-danmaku-context-menu");for(var n=function(n){var i=t[n];if(e.player.options.danmaku.contextMenu){var r=e.player.options.danmaku.contextMenu(i.danmaku);r[e.player.options.ui.copy]=function(){re(i.danmaku.text)};var o=ie(i,r);e.$menu.append(o)}},i=0;i<t.length;i++)n(i);document.body.append(this.$menu)}},{key:"show",value:function(){this.isShow=!0}},{key:"hide",value:function(){this.isShow=!1}},{key:"clear",value:function(){var t,e,n;for(var i in this.showed.length=0,this.canvas.clear(),this.canvas.clearCache(),(t=this.topAndBottomDisables).push.apply(t,Nt(this.topEnables)),(e=this.topAndBottomDisables).push.apply(e,Nt(this.bottomEnables)),this.topEnables.length=0,this.bottomEnables.length=0,(n=this.flowDisables).push.apply(n,Nt(this.flowEnables)),this.flowEnables.length=0,this.flowLines)this.flowLines[i]=null;for(var r in this.topLines)this.topLines[r]=null;for(var o in this.bottomLines)this.bottomLines[o]=null}},{key:"resize",value:function(){this.width=this.player.$root.clientWidth,this.height=this.player.$root.clientHeight,this.lineHeight=Math.round(this.canvas.fontHeight(this.player.options.danmaku.fontSize)),this.lineHeights.length=0;for(var t=0;t<window.screen.height;t++){var e=t*this.lineHeight;if(e>window.screen.height)break;this.lineHeights.push(e),Object.prototype.hasOwnProperty.call(this.topLines,e)||(this.topLines[e]=null),Object.prototype.hasOwnProperty.call(this.bottomLines,e)||(this.bottomLines[e]=null),Object.prototype.hasOwnProperty.call(this.flowLines,e)||(this.flowLines[e]=null)}this.canvas.resize();var n=this.player.options.danmaku.limit;n===Ut.Percent75?this.displayArea=.75*this.player.height:n===Ut.Half?this.displayArea=.5*this.player.height:n===Ut.Percent25?this.displayArea=.25*this.player.height:this.displayArea=this.player.height,this.canvas.alpha=this.player.options.danmaku.alpha,this.canvas.clear(),this.canvas.renderAll()}},{key:"toggle",value:function(){this.isShow?this.hide():this.show()}},{key:"send",value:function(t){t.text=t.text.trim(),this.danmakus.push(t)}},{key:"findDrawers",value:function(e){return[].concat(Nt(this.topEnables.filter((function(n){return t.find(e,n)}))),Nt(this.bottomEnables.filter((function(n){return t.find(e,n)}))),Nt(this.flowEnables.filter((function(n){return t.find(e,n)}))))}},{key:"createDrawer",value:function(t){var e;if(t.type===gt.Flow){var n=this.flowDisables.shift()||new Ct;e=this.calcFlowY(),e>-1?(n.enable=!0,n.set(t,this.width,e),n.update(this.width,this.player.options.danmaku.flowDuration,0),this.flowEnables.push(n),this.flowLines[e]=n,this.canvas.addDrawer(n)):this.flowDisables.push(n)}else{var i=this.topAndBottomDisables.shift()||new Rt;if(t.type===gt.Top)e=this.calcTopY(),e>-1?(i.enable=!0,i.set(t,this.player.options.danmaku.fadeoutDuration,this.width,e),this.topLines[e]=i,i.update(0),this.topEnables.push(i),this.canvas.addDrawer(i)):this.topAndBottomDisables.push(i);else{var r=this.calcBottomY();r>-1?(i.enable=!0,this.bottomLines[r]=i,r=this.height-(r+this.lineHeight),i.set(t,this.player.options.danmaku.fadeoutDuration,this.width,r),this.bottomEnables.push(i),i.update(0),this.canvas.addDrawer(i)):this.topAndBottomDisables.push(i)}}}},{key:"addDanmakuToCanvas",value:function(){var t=this;if(0!==this.danmakus.length&&this.player.options.danmaku.enable){if(this.player.options.live)this.danmakus.forEach((function(e){t.createDrawer(e)})),this.danmakus.length=0;else for(var e=0;e<this.danmakus.length;e++){var n=this.danmakus[e];if(!this.showed.includes(n)){var i=Math.abs(this.player.currentTime-n.currentTime);i>.1||(this.showed.push(n),this.createDrawer(n))}}this.canvas.renderAll()}}},{key:"calcFlowY",value:function(){for(var t in this.flowLines){var e=this.flowLines[t];if(e&&e.enable){var n=e.left+e.width;if(n>this.width)continue}var i=Number(t);if(i>this.displayArea)break;return this.flowY=i,i}return this.player.options.danmaku.limit!==Ut.UnLimited?-1:(this.flowY+=this.lineHeight,this.flowY>this.displayArea&&(this.flowY=0),this.flowY)}},{key:"calcTopY",value:function(){for(var t in this.topLines){var e=this.topLines[t],n=Number(t);if(!e||!e.enable){if(n>this.displayArea)break;return this.topLineIndex=n,n}}return this.player.options.danmaku.limit!==Ut.UnLimited?-1:(this.topLineIndex+=this.lineHeight,this.topLineIndex>this.displayArea&&(this.topLineIndex=0),this.topLineIndex)}},{key:"calcBottomY",value:function(){if(this.player.options.danmaku.limit===Ut.Percent25||this.player.options.danmaku.limit===Ut.Half||this.player.options.danmaku.limit===Ut.Percent75)return-1;for(var t in this.bottomLines){var e=this.bottomLines[t],n=Number(t);if(!e||!e.enable){if(n>this.displayArea)break;return this.bottomY=n,n}}return this.player.options.danmaku.limit!==Ut.UnLimited?-1:(this.bottomY+=this.lineHeight,this.bottomY>this.displayArea&&(this.bottomY=0),this.bottomY)}},{key:"updateDanmaku",value:function(){var t=this;this.topEnables=this.topEnables.filter((function(e){return e.enable?(e.update(t.frameTime),!0):(t.topLines[e.height]===e&&(t.topLines[e.height]=null),t.canvas.removeDrawer(e),t.topAndBottomDisables.push(e),!1)})),this.bottomEnables=this.bottomEnables.filter((function(e){return e.enable?(e.update(t.frameTime),!0):(t.bottomLines[e.height]===e&&(t.bottomLines[e.height]=null),t.canvas.removeDrawer(e),t.topAndBottomDisables.push(e),!1)})),this.flowEnables=this.flowEnables.filter((function(e){return e.enable?(e.update(t.width,t.player.options.danmaku.flowDuration,t.frameTime),!0):(t.flowLines[e.height]===e&&(t.flowLines[e.height]=null),t.canvas.removeDrawer(e),t.flowDisables.push(e),!1)}))}},{key:"update",value:function(){this.player.options.danmaku.enable&&this.isShow?this.show():this.hide()}},{key:"loop",value:function(){var t=this;this.destroied||(this.addDanmakuToCanvas(),this.addDanmakuToCanvasTime=(Date.now()-this.lastFrame)/1e3,this.canvas.clear(),this.player.paused||(this.updateDanmaku(),this.updateDanmakuTime=(Date.now()-this.lastFrame)/1e3),this.player.options.danmaku.enable&&this.isShow&&this.canvas.renderAll(),this.frameTime=(Date.now()-this.lastFrame)/1e3,this.lastFrame=Date.now(),window.requestAnimationFrame((function(){t.loop()})))}},{key:"destroy",value:function(){this.destroied=!0,clearInterval(this.calcTopInterval),this.$menu&&this.$menu.remove()}},{key:"debug",get:function(){return{enable:this.player.options.danmaku.enable,isShow:this.isShow,all:this.danmakus.length,showed:this.showed.length,time:{addDanmakuToCanvas:this.addDanmakuToCanvasTime,drawDanmaku:this.updateDanmakuTime,frameTime:this.frameTime},"on screen danmakus":{top:this.topEnables.length,bottom:this.bottomEnables.length,flow:this.flowEnables.length},"danmaku pool":{fixed:this.topAndBottomDisables.length,flow:this.flowDisables.length},positionY:{top:this.topLineIndex,flow:this.flowY,bottom:this.bottomY}}}}],[{key:"find",value:function(t,e){return t.offsetX>e.left&&t.offsetX<e.left+e.width&&t.offsetY>e.top&&t.offsetY<e.top+e.height}}]),t}();function ae(t){return ae="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ae(t)}function se(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function le(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ue(t,e,n){return e&&le(t.prototype,e),n&&le(t,n),t}function ce(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&de(t,e)}function de(t,e){return de=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},de(t,e)}function he(t){var e=ye();return function(){var n,i=ve(t);if(e){var r=ve(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return pe(this,n)}}function pe(t,e){return!e||"object"!==ae(e)&&"function"!==typeof e?fe(t):e}function fe(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ye(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function ve(t){return ve=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ve(t)}var me='<div><span class="danmaku-type"></span>\n<div class="types">\n  <div class="type" data-type="1">\n    <div>\n        <svg class="icon"><use xlink:href="#danplayer-danmugundongkai"></use></svg>\n    </div>\n    <span class="danmaku-type-flow"></span>\n  </div>\n  <div class="type" data-type="0">\n    <div>\n        <svg class="icon"><use xlink:href="#danplayer-danmudingbukai"></use></svg>\n    </div>\n    <span class="danmaku-type-top"></span>\n  </div>\n  <div class="type" data-type="2">\n    <div>\n        <svg class="icon"><use xlink:href="#danplayer-danmudibukai"></use></svg>\n    </div>\n    <span class="danmaku-type-bottom"></span>\n  </div>\n</div>\n</div>\n<div><span class="danmaku-color"></span>\n<div class="colors">\n{colors}\n</div>\n</div>',be=function(t){ce(n,t);var e=he(n);function n(t){var i;return se(this,n),i=e.call(this,t),i.fill="#ffffff",i.type=gt.Flow,i.$layer=i.player.$root.querySelector(".float.danmaku-style-layer"),i.$btn=i.player.$root.querySelector(".intern-button.danmaku-style"),i.$layer.innerHTML=me.replace("{colors}",n.colors.map((function(t){return'<span style="background: '.concat(t,'" data-color="').concat(t,'"></span>')})).join("")),i.init(),i.$types=Array.from(i.$layer.querySelectorAll(".types > .type")),i.$colors=Array.from(i.$layer.querySelectorAll(".colors > span")),i.$types.forEach((function(t){return t.addEventListener("click",(function(){i.$types.forEach((function(t){return t.classList.remove("selected")})),t.classList.add("selected"),i.type=Number(t.getAttribute("data-type"))}))})),i.$colors.forEach((function(t){return t.addEventListener("click",(function(){i.$colors.forEach((function(t){return t.classList.remove("selected")})),t.classList.add("selected"),i.fill=t.getAttribute("data-color")}))})),i.$types[0].classList.add("selected"),i.$colors[i.$colors.length-1].classList.add("selected"),i.update(),i}return ue(n,[{key:"getStyle",value:function(){return{fill:this.fill,type:this.type,borderColor:"white"}}},{key:"update",value:function(){var t=this.$layer.querySelector(".danmaku-type"),e=this.$layer.querySelector(".danmaku-type-flow"),n=this.$layer.querySelector(".danmaku-type-top"),i=this.$layer.querySelector(".danmaku-type-bottom"),r=this.$layer.querySelector(".danmaku-color");r.innerText=this.ui.string.danmakuColor,t.innerText=this.ui.string.danmakuType,e.innerText=this.ui.string.danmakuTypeFlow,n.innerText=this.ui.string.danmakuTypeTopFixed,i.innerText=this.ui.string.danmakuTypeBottomFixed}}]),n}(S);function ge(t,e,n,i,r,o,a){try{var s=t[o](a),l=s.value}catch(u){return void n(u)}s.done?e(l):Promise.resolve(l).then(i,r)}function ke(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var o=t.apply(e,n);function a(t){ge(o,i,r,a,s,"next",t)}function s(t){ge(o,i,r,a,s,"throw",t)}a(void 0)}))}}function we(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function $e(t,e,n){return e&&xe(t.prototype,e),n&&xe(t,n),t}be.colors=["#FE0302","#FF7204","#FFAA02","#FFD302","#FFFF00","#A0EE00","#00CD00","#019899","#4266BE","#89D5FF","#CC0273","#222222","#9B9B9B","#FFFFFF"];var Se=function(){function t(e){var n=this;we(this,t),this.isShow=!1,this.ui=e,this.styleLayer=new be(e),this.$root=e.player.$root.querySelector(".danmaku-form"),this.$input=this.$root.querySelector("input"),this.$btn=this.$root.querySelector(".send"),this.$btn.addEventListener("click",(function(){return n.send()})),this.$input.addEventListener("keypress",(function(t){"Enter"===t.key&&n.ui.isShow&&(n.send(),n.ui.hide(),n.$root.focus()),t.stopPropagation()})),this.$input.addEventListener("keyup",(function(t){t.stopPropagation()})),this.$input.addEventListener("keydown",(function(t){"Escape"===t.key&&(n.$root.focus(),n.ui.hide()),t.stopPropagation()})),this.$input.addEventListener("focus",(function(){n.ui.isMouseInUI=!0})),this.$input.addEventListener("blur",(function(){n.ui.isMouseInUI=!1}))}return $e(t,[{key:"send",value:function(){var t=ke(s.a.mark((function t(){var e,n,i,r;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=this.$input.value.trim(),e){t.next=3;break}return t.abrupt("return");case 3:if(n=this.styleLayer.getStyle(),n.currentTime=this.ui.player.currentTime,i=new $t(e,n),!this.ui.player.options.beforeSendDanmaku){t.next=12;break}return t.next=9,Promise.resolve(this.ui.player.options.beforeSendDanmaku(i));case 9:if(r=t.sent,r){t.next=12;break}return t.abrupt("return");case 12:this.ui.danmakuLayer.send(i),this.$input.value="";case 14:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"show",value:function(){this.isShow=!0,this.$root.style.display=""}},{key:"hide",value:function(){this.isShow=!1,this.$root.style.display="none"}},{key:"update",value:function(){this.$btn.innerText=this.ui.string.danmakuSend,this.$input.placeholder=this.ui.string.danmakuInputHint,this.ui.player.options.danmakuForm?this.show():this.hide()}},{key:"focus",value:function(){this.$input.focus()}}]),t}();function Le(t,e,n,i,r,o,a){try{var s=t[o](a),l=s.value}catch(u){return void n(u)}s.done?e(l):Promise.resolve(l).then(i,r)}function Ee(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var o=t.apply(e,n);function a(t){Le(o,i,r,a,s,"next",t)}function s(t){Le(o,i,r,a,s,"throw",t)}a(void 0)}))}}function Oe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function De(t,e,n){return e&&Oe(t.prototype,e),n&&Oe(t,n),t}function Pe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _e=function t(){Pe(this,t),this.live="直播",this.play="播放",this.pause="暂停",this.volume="音量",this.danmakuInputHint="输入弹幕内容",this.danmakuSend="发送",this.danmakuType="类型",this.danmakuTypeFlow="流动",this.danmakuTypeTopFixed="顶部",this.danmakuTypeBottomFixed="底部",this.danmakuColor="颜色",this.fullscreen="全屏观看",this.cancelFullscreen="取消全屏",this.switchQuality="切换画质",this.showDanmaku="显示弹幕",this.hideDanmaku="隐藏弹幕",this.autoQualitySelect="自动",this.copy="复制",this.loading="读取中",this.pictureInPictureOn="开启画中画",this.pictureInPictureOff="退出画中画"},Te=function(){function t(e){var n=this;Pe(this,t),this._isMouseInUI=!1,this.isShow=!1,this.extraButtons=[],this.hideTimeout=-1,this.player=e,this.$root=e.$root.querySelector(".interactive-layer"),this.$controlBar=e.$root.querySelector(".interactive-layer .controller-bottom-bar"),this.$controlBar.addEventListener("mouseenter",(function(){n.isMouseInUI=!0})),this.$controlBar.addEventListener("mouseleave",(function(){n.isMouseInUI=!1})),this.$gradientBG=e.$root.querySelector(".bg-gradient"),this.string=e.options.ui,this.volume=new N(this),this.qualitySelector=new ht(this),this.progressBar=new kt(this),this.danmakuStyleLayer=new be(this),this.danmakuForm=new Se(this),this.$loading=this.$root.querySelector(".float.loading"),this.$controllerButtonsRightLayout=this.$controlBar.querySelector(".buttons .right"),this.btnFullScreen=new D(this.$controlBar.querySelector(".button.full-screen")),this.btnPIP=new D(this.$controlBar.querySelector(".button.picture-in-picture")),this.btnPIP.$root.addEventListener("click",(function(){n.player.togglePictureInPicture().then((function(){n.updatePIPButton()}))})),this.btnFullScreen.$root.addEventListener("click",Ee(s.a.mark((function t(){return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n.player.toggleFullScreen();case 2:n.updateFullScreenButton();case 3:case"end":return t.stop()}}),t)})))),this.btnPlay=new D(this.$controlBar.querySelector(".button.play")),this.btnPlay.$root.addEventListener("click",(function(){n.player.toggle(),n.updatePlayButton()})),this.btnShowDanmaku=new D(this.$controlBar.querySelector(".button.toggle-danamaku")),this.btnShowDanmaku.$root.addEventListener("click",(function(){n.danmakuLayer.toggle(),n.updateDanmakuButton()})),this.player.$video.addEventListener("waiting",(function(){n.$loading.classList.add("show")})),this.player.$video.addEventListener("canplay",(function(){n.$loading.classList.remove("show")})),this.$loading.innerText=this.string.loading,this.$loading.classList.add("show"),this.danmakuLayer=new oe(e),this.insertExtraButtons()}return De(t,[{key:"show",value:function(){this.isShow=!0,this.$controlBar.classList.add("show"),this.$gradientBG.classList.add("show"),this.progressBar.resize()}},{key:"hide",value:function(){this.isShow=!1,this.$controlBar.classList.remove("show"),this.$gradientBG.classList.remove("show"),this.qualitySelector.hideLayer(),this.volume.hideLayer(),this.danmakuForm.styleLayer.hideLayer(),this.player.$root.focus(),this.progressBar.update()}},{key:"hideUIDelay",value:function(){var t=this;return this.cancelHideUIDelay(),new Promise((function(e){t.hideTimeout=window.setTimeout((function(){t.hide(),e()}),t.player.options.uiFadeOutDelay)}))}},{key:"cancelHideUIDelay",value:function(){clearTimeout(this.hideTimeout)}},{key:"clearExtraButtons",value:function(){this.extraButtons.forEach((function(t){return t.remove()})),this.extraButtons.length=0}},{key:"insertExtraButtons",value:function(){var t=this;if(this.clearExtraButtons(),this.player.options.extraButtons instanceof Array)this.player.options.extraButtons.forEach((function(e){t.$controllerButtonsRightLayout.prepend(e),t.extraButtons.push(e)}));else for(var e in this.player.options.extraButtons){var n=document.createElement("div");n.innerText=e,n.addEventListener("click",this.player.options.extraButtons[e]),n.classList.add("button"),this.$controllerButtonsRightLayout.prepend(n),this.extraButtons.push(n)}}},{key:"update",value:function(){this.updateDanmakuButton(),this.updateFullScreenButton(),this.updatePlayButton(),this.updatePIPButton(),this.danmakuForm.update(),this.progressBar.update(),this.volume.update(),this.danmakuLayer.update(),this.danmakuStyleLayer.update(),this.qualitySelector.update(),this.$loading.innerText=this.string.loading}},{key:"updatePlayButton",value:function(){this.btnPlay.$root.setAttribute("data-on-title",this.string.play),this.btnPlay.$root.setAttribute("data-off-title",this.string.pause),this.player.paused?this.btnPlay.switch("data-on","data-on-title"):this.btnPlay.switch("data-off","data-off-title")}},{key:"updateFullScreenButton",value:function(){this.btnFullScreen.$root.setAttribute("data-on-title",this.string.fullscreen),this.btnFullScreen.$root.setAttribute("data-off-title",this.string.cancelFullscreen),this.btnFullScreen.$root.style.display=this.player.options.fullScreen?"":"none",this.player.isFullScreen?this.btnFullScreen.switch("data-off","data-off-title"):this.btnFullScreen.switch("data-on","data-on-title")}},{key:"updatePIPButton",value:function(){this.btnPIP.$root.style.display=this.player.isSupportPictureInPicture&&this.player.options.pictureInPicture?"":"none",this.btnPIP.$root.setAttribute("title",this.player.isInPictureInPicture?this.string.pictureInPictureOff:this.string.pictureInPictureOn)}},{key:"updateDanmakuButton",value:function(){var t,e;(this.btnShowDanmaku.$root.setAttribute("data-on-title",this.string.showDanmaku),this.btnShowDanmaku.$root.setAttribute("data-off-title",this.string.hideDanmaku),this.player.options.danmaku.enable)?(this.danmakuLayer.isShow?(t="data-on",e="data-on-title"):(t="data-off",e="data-off-title"),this.btnShowDanmaku.switch(t,e),this.btnShowDanmaku.show()):this.btnShowDanmaku.hide()}},{key:"resize",value:function(){this.qualitySelector.isShow&&this.qualitySelector.updateLayerPosition(),this.volume.update(),this.progressBar.resize(),this.danmakuLayer.resize()}},{key:"destroy",value:function(){clearTimeout(this.hideTimeout),this.danmakuLayer.destroy(),this.qualitySelector.destroy(),this.volume.destroy()}},{key:"isMouseInUI",set:function(t){this._isMouseInUI=t,this.cancelHideUIDelay()},get:function(){return this._isMouseInUI}},{key:"debug",get:function(){return{isShow:this.isShow,isMouseInUI:this._isMouseInUI,danmakuLayer:this.danmakuLayer.debug}}}]),t}();function je(t){return je="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},je(t)}function Be(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Fe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ie(t,e,n){return e&&Fe(t.prototype,e),n&&Fe(t,n),t}function Ae(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ce(t,e)}function Ce(t,e){return Ce=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Ce(t,e)}function Re(t){var e=Me();return function(){var n,i=He(t);if(e){var r=He(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return qe(this,n)}}function qe(t,e){return!e||"object"!==je(e)&&"function"!==typeof e?ze(t):e}function ze(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Me(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function He(t){return He=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},He(t)}var Ue={OnLoad:"OnLoaded",OnChanged:"OnChanged"};function Ye(t){var e={};return t.levels.forEach((function(t,n){var i;i=t.name?t.name:t.width&&t.height?Math.min(t.width,t.height)+"P":t.attrs["RESOLUTION"]?t.attrs["RESOLUTION"]:"Lv "+n,e[i]&&e[i].bitrate>t.bitrate||(e[i]={selected:!1,name:i,index:n,bitrate:t.bitrate})})),Object.values(e)}function We(t){var e={},n=t.getBitrateInfoListFor("video");return n.forEach((function(t,n){if("height"in t){var i=Math.min(t.width,t.height)+"P";e[i]&&e[i].bitrate>t.bitrate||(e[i]={selected:!1,name:i,index:t.qualityIndex,bitrate:t.bitrate})}})),Object.values(e)}var Ne=function(t){Ae(n,t);var e=Re(n);function n(){var t;return Be(this,n),t=e.call(this),t}return Ie(n,[{key:"useHls",value:function(t){var e=this;this.hls=t,this.dash=void 0,t.on(Hls.Events.LEVEL_LOADED,(function(){e.emit(n.Events.OnLoad,Ye(t))}))}},{key:"useDash",value:function(t){var e=this;this.dash=t,this.hls=void 0,t.on("streamInitialized",(function(){e.emit(n.Events.OnLoad,We(t))}))}},{key:"changeLevelTo",value:function(t){if(this._level=t,this.hls)this.hls.currentLevel=t.index;else if(this.dash){var e=this.dash.getSettings();if(e.streaming&&e.streaming.abr){var n=-1===t.index;n||this.dash.setQualityFor("video",t.index),e.streaming.abr.autoSwitchBitrate&&(e.streaming.abr.autoSwitchBitrate.video=n),e.streaming.abr.limitBitrateByPortal=n}this.dash.updateSettings(e)}}},{key:"currentLevel",get:function(){return this._level}}]),n}(c["EventEmitter"]);function Ve(t){return Ve="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ve(t)}function Qe(t){return Ze(t)||Je(t)||Xe(t)||Ge()}function Ge(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Xe(t,e){if(t){if("string"===typeof t)return Ke(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ke(t,e):void 0}}function Je(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function Ze(t){if(Array.isArray(t))return Ke(t)}function Ke(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function tn(t,e,n,i,r,o,a){try{var s=t[o](a),l=s.value}catch(u){return void n(u)}s.done?e(l):Promise.resolve(l).then(i,r)}function en(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var o=t.apply(e,n);function a(t){tn(o,i,r,a,s,"next",t)}function s(t){tn(o,i,r,a,s,"throw",t)}a(void 0)}))}}function nn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function on(t,e,n){return e&&rn(t.prototype,e),n&&rn(t,n),t}function an(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sn(t,e)}function sn(t,e){return sn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},sn(t,e)}function ln(t){var e=dn();return function(){var n,i=hn(t);if(e){var r=hn(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return un(this,n)}}function un(t,e){return!e||"object"!==Ve(e)&&"function"!==typeof e?cn(t):e}function cn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function dn(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function hn(t){return hn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},hn(t)}Ne.Events=Ue;var pn,fn,yn="0.0.37",vn="//at.alicdn.com/t/font_1373341_eeojr5zqmon.js",mn="#00a1d6";function bn(t){var e=t.autoplay,n=void 0!==e&&e,i=t.color,r=void 0===i?mn:i,o=t.live,a=void 0!==o&&o,s=t.volume,l=void 0===s?.7:s,u=t.width,c=void 0===u?600:u,d=t.height,h=void 0===d?350:d,p=t.uiFadeOutDelay,f=void 0===p?3e3:p,y=t.extraButtons,v=void 0===y?[]:y,m=t.src,b=void 0===m?"":m,g=t.iconSrc,k=void 0===g?vn:g,w=t.danmakuForm,x=void 0===w||w,$=t.fullScreen,S=void 0===$||$,L=t.beforeSendDanmaku,E=void 0===L?void 0:L,O=t.danmaku,D=void 0===O?{}:O,P=t.forward,_=void 0===P?5:P,T=t.backward,j=void 0===T?5:T,B=t.unique,F=void 0!==B&&B,I=t.forceUse,A=void 0===I?void 0:I,C=t.ui,R=void 0===C?void 0:C,q=t.preload,z=void 0===q?"none":q,M=t.timeFormat,H=t.pictureInPicture,U=void 0===H||H;(l<0||l>1)&&(l=.7);var Y=Object.assign(new _e,R||{});return{autoplay:n,color:r,live:a,height:h,danmaku:ee(D),danmakuForm:x,fullScreen:S,src:b,iconSrc:k,forward:_,backward:j,uiFadeOutDelay:f,extraButtons:v,unique:F,volume:l,beforeSendDanmaku:E,width:c,forceUse:A,ui:Y,preload:z,timeFormat:M,pictureInPicture:U}}(function(t){t[t["Hls"]=1]="Hls",t[t["Dash"]=2]="Dash"})(pn||(pn={})),function(t){t["Normal"]="native",t["Hls"]="hls.js",t["Dash"]="dash.js"}(fn||(fn={}));var gn,kn,wn='{video-layer}\n<div class="interactive-layer">\n  <canvas class="danmaku-layer"></canvas>\n\n  <div class="bg-gradient show"></div>\n\n\n  <div class="float danmaku-style-layer"></div>\n\n  <div class="float volume-bar">\n    <div class="volume-num-label"></div>\n    <div class="volume-column-bar">\n      <div class="bar-ui bar-full"></div>\n      <div class="bar-ui bar-current"></div>\n      <div class="bar-controller"></div>\n    </div>\n  </div>\n\n  <div class="float quality-menu"></div>\n  \n  <div class="float loading show"></div>\n\n  <div class="controller-bottom-bar">\n    <div class="progress-bar live-hide">\n      <div class="bar-full"></div>\n      <div class="bar-buffer"></div>\n      <div class="bar-current"></div>\n      <div class="bar-controller"></div>\n    </div>\n\n    <div class="buttons">\n      <div class="left">\n        <div class="button intern-button play" data-on="danplayer-bofang" data-off="danplayer-zanting"\n          data-on-title="{play}" data-off-title="{pause}">\n          <svg class="icon" aria-hidden="true"><use xlink:href="#danplayer-bofang"></use></svg>\n        </div>\n        <div class="time"></div>\n      </div>\n\n      <div class="middle danmaku-form">\n        <div class="button intern-button danmaku-style">\n          <svg class="icon"><use xlink:href="#danplayer-style"></use></svg>\n        </div>\n        <input placeholder="{danmakuInputHint}" tabindex="1">\n        <div class="send">{danmakuSend}</div>\n      </div>\n      <div class="right">\n\n        <div class="button intern-button volume" data-on="danplayer-yinliang" data-off="danplayer-jingyin" title="{volume}">\n          <svg class="icon"><use xlink:href="#danplayer-yinliang"></use></svg>\n        </div>\n\n        <div class="button intern-button toggle-danamaku" title="隐藏弹幕"\n          data-on="danplayer-danmuguan" data-off="danplayer-danmukai"\n          data-on-title="{showDanmaku}" data-off-title="{hideDanmaku}">\n          <svg class="icon"><use xlink:href="#danplayer-danmukai"></use></svg>\n        </div>\n\n        <div class="button quality" title="{switchQuality}"></div>\n\n        <div class="button intern-button picture-in-picture">\n          <svg class="icon"><use xlink:href="#danplayer-pip"></use></svg>\n        </div>\n        \n        <div class="button intern-button full-screen" data-on="danplayer-quanping" data-off="danplayer-zuixiaohua"\n        data-on-title="{fullscreen}" data-off-title="{cancelFullscreen}">\n          <svg class="icon"><use xlink:href="#danplayer-quanping"></use></svg>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>',xn=function(t){an(n,t);var e=ln(n);function n(t,i){var r,o;nn(this,n),o=e.call(this),o.type=fn.Normal,o.isSupportPictureInPicture=!!document.pictureInPictureEnabled,o.clickEvent="ontouchstart"in document.documentElement?"touchstart":"click",o._width="",o._height="",o._duration=0,o._loading=!0,o._paused=!0,o._isFullScreen=!1,o.delayResize=-1,console.info("DanPlayer v".concat(yn)),i=i||{},o.options=bn(i);var a=ft(vn);if(!document.querySelector("script#danplayer-icon"+a)){var s=document.createElement("script");s.src=vn,s.id="danplayer-icon",document.body.append(s)}n.instances.push(cn(o));var l,u=t.parentElement;return o.$root=document.createElement("div"),o.id=yt(),o.$root.setAttribute("data-style",o.id),o.$root.setAttribute("tabIndex","0"),o.$root.classList.add("danplayer"),u.insertBefore(o.$root,t),"video"===t.tagName.toLowerCase()?(t.classList.add("video-layer"),t.removeAttribute("id"),l=t.outerHTML,i&&!("src"in i)&&(i.src=t.getAttribute("src"))):l='<video class="video-layer"></video>',o.$root.innerHTML=wn.replace("{video-layer}",l).replace("{volume}",o.options.ui.volume).replace("{showDanmaku}",o.options.ui.showDanmaku).replace("{hideDanmaku}",o.options.ui.hideDanmaku).replace("{play}",o.options.ui.play).replace("{pause}",o.options.ui.pause).replace("{danmakuInputHint}",o.options.ui.danmakuInputHint).replace("{danmakuSend}",o.options.ui.danmakuSend).replace("{fullscreen}",o.options.ui.fullscreen).replace("{cancelFullscreen}",o.options.ui.cancelFullscreen).replace("{switchQuality}",o.options.ui.switchQuality),t.remove(),o.$root.addEventListener("contextmenu",(function(t){t.stopPropagation(),t.preventDefault()})),o.$root.addEventListener("keypress",(function(t){"Enter"===t.key?(o.ui.show(),o.ui.danmakuForm.focus()):" "===t.key&&(o.toggle(),t.stopPropagation(),t.preventDefault())})),o.$root.addEventListener("keydown",(function(t){var e=t.key.startsWith("Arrow");o.options.live||("ArrowLeft"===t.key?o.$video.currentTime-=o.options.backward:"ArrowRight"===t.key&&(o.$video.currentTime+=o.options.forward)),"ArrowUp"===t.key?o.ui.volume.up():"ArrowDown"===t.key&&o.ui.volume.down(),e&&(t.stopPropagation(),t.preventDefault())})),document.addEventListener("fullscreenchange",(function(){o._isFullScreen=document.fullscreenElement===o.$root,o.ui.updateFullScreenButton()})),o.$root.addEventListener("mousemove",(function(){o.$root.classList.remove("mouse-idle"),o.ui.isShow||(o.ui.show(),o.ui.cancelHideUIDelay()),o.paused||o.ui.isMouseInUI||o.ui.hideUIDelay().then((function(){o.$root.classList.add("mouse-idle")}))})),o.$root.addEventListener("touchstart",(function(){o.ui.show(),o.ui.cancelHideUIDelay()})),o.$root.addEventListener("touchend",(function(){o.ui.hideUIDelay()})),o.$root.addEventListener("mouseover",(function(){o.ui.isShow||(o.$root.classList.remove("mouse-idle"),o.ui.show(),o.ui.cancelHideUIDelay())})),o.$root.addEventListener("mouseleave",(function(){o.ui.isShow&&(o.ui.hide(),o.ui.cancelHideUIDelay())})),o.$video=o.$root.querySelector(".video-layer"),o.$video.removeAttribute("controls"),o.$video.addEventListener("durationchange",(function(){o._duration=o.$video.duration})),o.$video.setAttribute("preload",o.options.preload),o.$video.addEventListener("playing",(function(){return o.ui.hideUIDelay()})),o.$video.addEventListener("play",(function(){return o.ui.updatePlayButton()})),o.$video.addEventListener("pause",(function(){return o.ui.updatePlayButton()})),o.$video.addEventListener("error",(function(){return o.errorHandler()})),o.$video.addEventListener("loadedmetadata",(function(){o.type===fn.Normal?o.ui.qualitySelector.hideButton():o.ui.qualitySelector.showButton()})),"width"in i||(i.width=o.$video.clientWidth),"height"in i||(i.width=o.$video.clientHeight),"autoplay"in i||(i.autoplay=o.$video.hasAttribute("autoplay")),window.addEventListener("resize",(function(){return o.resizeEvt(1e3)})),o.adapter=new Ne,o.ui=new Te(cn(o)),o.ui.show(),o.ui.progressBar.init(),o.ui.hideUIDelay(),o.adapter.on(Ne.Events.OnLoad,(function(t){o.ui.qualitySelector.updateLevel(t)})),o.ui.qualitySelector.on("selectLevel",(function(t){o.ui.progressBar.resetProgressBar(),o.adapter.changeLevelTo(t)})),o.updateUI(),o.updateSrc().then(),(null===(r=i)||void 0===r?void 0:r.forceUse)&&o.errorHandler(),o}return on(n,[{key:"updateSrc",value:function(){var t=en(s.a.mark((function t(){return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.type=fn.Normal,this.$video.src=this.options.src,!this.options.autoplay&&this.paused||this.play();case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"updateUI",value:function(){this.ui.string=this.options.ui,this.ui.insertExtraButtons(),this.ui.update(),this.ui.progressBar.resize(),this.resize(),this.$style&&this.$style.remove(),this.options.color!==mn&&(this.$style=document.createElement("style"),this.$style.innerHTML='\n.danplayer[data-style="'.concat(this.id,'"] .colors .selected{border-color:').concat(this.options.color,' !important}\n.danplayer[data-style="').concat(this.id,'"] .types .selected{color:').concat(this.options.color,' !important}\n.danplayer[data-style="').concat(this.id,'"] .quality-menu .current{color:').concat(this.options.color,' !important}\n\n.danplayer[data-style="').concat(this.id,'"] .volume-bar .bar-controller{background:').concat(this.options.color,' !important}\n.danplayer[data-style="').concat(this.id,'"] .volume-bar .bar-current{background:').concat(this.options.color,' !important}\n\n.danplayer[data-style="').concat(this.id,'"] .progress-bar .bar-controller{background:').concat(this.options.color,' !important}\n.danplayer[data-style="').concat(this.id,'"] .progress-bar .bar-current{background:').concat(this.options.color," !important}\n"),this.$root.append(this.$style)),this.ui.qualitySelector.update(),this.options.live?this.$root.classList.add("live"):this.$root.classList.remove("live"),this.$video.volume=this.options.volume}},{key:"set",value:function(t){var e=t.src!==this.options.src;t.ui=Object.assign({},new _e,t.ui),t.danmaku=Object.assign({},this.options.danmaku,t.danmaku);var n=Object.assign({},this.options,t),i=JSON.stringify(n)===JSON.stringify(this.options);e&&(t.forceUse||(n.forceUse=void 0)),this.options=n,this.$video.setAttribute("preload",this.options.preload),e&&(this.hls&&(this.hls.detachMedia(),this.hls=void 0),this.dash&&(this.dash.reset(),this.dash=void 0),this.ui.progressBar.reset(),this.ui.qualitySelector.reset(),this.updateSrc().then()),this.updateUI(),i&&this.emit("optionChanged",this),(null===t||void 0===t?void 0:t.forceUse)&&this.errorHandler()}},{key:"resize",value:function(){this.options.width&&("number"===typeof this.options.width||parseInt(this.options.width).toString()===this.options.width?this._width=this.options.width+"px":this._width=this.options.width),this.options.height&&("number"===typeof this.options.height||parseInt(this.options.height).toString()===this.options.height?this._height=this.options.height+"px":this._height=this.options.height),this._isFullScreen||(this.$root.style.width=this._width,this.$root.style.height=this._height),this.ui.resize()}},{key:"resizeEvt",value:function(t){var e=this;window.clearTimeout(this.delayResize),this.delayResize=window.setTimeout((function(){e.resize()}),t)}},{key:"fillDanmakus",value:function(t){var e;(e=this.ui.danmakuLayer.danmakus).push.apply(e,Qe(t))}},{key:"sendDanmaku",value:function(t){this.ui.danmakuLayer.send(t)}},{key:"clearDanmaku",value:function(){this.ui.danmakuLayer.clear()}},{key:"toggle",value:function(){this.paused?this.play():this.pause()}},{key:"play",value:function(){var t=this;this._paused=!1,this.$video.play().then(),this.options.unique&&n.instances.forEach((function(e){e!==t&&e.pause()}))}},{key:"pause",value:function(){this._paused=!0,this.$video.pause()}},{key:"errorHandler",value:function(){var t=en(s.a.mark((function t(){var e,n;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.options.forceUse===pn.Hls||this.options.src.match(/\.m3u[8]/)?(this.type=fn.Hls,this.hls&&this.hls.destroy(),this.hls=new Hls,this.hls.attachMedia(this.$video),this.hls.loadSource(this.options.src),this.hls.config.capLevelToPlayerSize=!0,this.adapter.useHls(this.hls)):(this.options.forceUse===pn.Dash||this.options.src.match(/\.mpd/))&&(this.type=fn.Dash,this.dash&&this.dash.reset(),this.dash=dashjs.MediaPlayer().create(),this.dash.initialize(this.$video,this.options.src,!this.$video.paused),n=this.dash.getSettings(),(null===(e=n.streaming)||void 0===e?void 0:e.abr)&&(n.streaming.abr.limitBitrateByPortal=!0),this.dash.updateSettings(n),this.adapter.useDash(this.dash)),this.$video.paused||(this.$video.setAttribute("autoplay",""),this.$video.play());case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"toggleFullScreen",value:function(){var t=en(s.a.mark((function t(){return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.options.fullScreen){t.next=2;break}return t.abrupt("return");case 2:if(this._isFullScreen=!this._isFullScreen,!this._isFullScreen){t.next=24;break}if(this.$root.classList.add("full-screen"),!this.$root.requestFullscreen){t.next=10;break}return t.next=8,this.$root.requestFullscreen();case 8:t.next=22;break;case 10:if(!this.$root.webkitRequestFullscreen){t.next=13;break}return t.next=13,this.$root.webkitRequestFullscreen();case 13:if(!this.$root.mozRequestFullScreen){t.next=16;break}return t.next=16,this.$root.mozRequestFullScreen();case 16:if(!this.$root.mozRequestFullScreen){t.next=19;break}return t.next=19,this.$root.mozRequestFullScreen();case 19:if(!this.$root.msRequestFullscreen){t.next=22;break}return t.next=22,this.$root.msRequestFullscreen();case 22:t.next=39;break;case 24:if(!document.exitFullscreen){t.next=29;break}return t.next=27,document.exitFullscreen();case 27:t.next=38;break;case 29:if(!document.mozCancelFullScreen){t.next=32;break}return t.next=32,document.mozCancelFullScreen();case 32:if(!document.webkitCancelFullScreen){t.next=35;break}return t.next=35,document.webkitCancelFullScreen();case 35:if(!document.msExitFullscreen){t.next=38;break}return t.next=38,document.msExitFullscreen();case 38:this.$root.classList.remove("full-screen");case 39:this.resize(),this.emit("toggleFullscreen");case 41:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"togglePictureInPicture",value:function(){var t=en(s.a.mark((function t(){return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.isSupportPictureInPicture){t.next=2;break}return t.abrupt("return");case 2:if(t.prev=2,this.$video===document.pictureInPictureElement){t.next=8;break}return t.next=6,this.$video.requestPictureInPicture();case 6:t.next=10;break;case 8:return t.next=10,document.exitPictureInPicture();case 10:t.next=14;break;case 12:t.prev=12,t.t0=t["catch"](2);case 14:return t.prev=14,t.finish(14);case 16:case"end":return t.stop()}}),t,this,[[2,12,14,16]])})));function e(){return t.apply(this,arguments)}return e}()},{key:"destroy",value:function(){n.instances.splice(n.instances.indexOf(this),1),this.ui.destroy(),this.hls&&this.hls.detachMedia(),this.dash&&this.dash.reset(),this.$style&&this.$style.remove(),this.$root.remove()}},{key:"isInPictureInPicture",get:function(){return this.$video===document.pictureInPictureElement}},{key:"width",get:function(){return this.$root.clientWidth}},{key:"height",get:function(){return this.$root.clientHeight}},{key:"isFullScreen",get:function(){return this._isFullScreen}},{key:"loading",get:function(){return this._loading}},{key:"currentTime",get:function(){return this.$video.currentTime}},{key:"paused",get:function(){return this._paused}},{key:"debug",get:function(){var t="默认",e=this.options.src;return this.type!==fn.Normal&&(t=this.adapter.currentLevel?this.adapter.currentLevel.name:"自动"),{id:this.id,width:this.width,height:this.height,type:this.type,src:e,quality:t,ui:this.ui.debug}}}]),n}(c["EventEmitter"]);function $n(t){return $n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$n(t)}function Sn(t,e,n,i,r,o,a){try{var s=t[o](a),l=s.value}catch(u){return void n(u)}s.done?e(l):Promise.resolve(l).then(i,r)}function Ln(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var o=t.apply(e,n);function a(t){Sn(o,i,r,a,s,"next",t)}function s(t){Sn(o,i,r,a,s,"throw",t)}a(void 0)}))}}function En(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function On(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Dn(t,e,n){return e&&On(t.prototype,e),n&&On(t,n),t}function Pn(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_n(t,e)}function _n(t,e){return _n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},_n(t,e)}function Tn(t){var e=Fn();return function(){var n,i=In(t);if(e){var r=In(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return jn(this,n)}}function jn(t,e){return!e||"object"!==$n(e)&&"function"!==typeof e?Bn(t):e}function Bn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Fn(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function In(t){return In=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},In(t)}xn.instances=[];var An=function(t){Pn(n,t);var e=Tn(n);function n(){var t;return En(this,n),t=e.apply(this,arguments),t.settings={danmaku:!0,danmakuForm:!("ontouchstart"in document.documentElement),flowDuration:1,fadeoutDuration:1,volume:.7,alpha:1,live:!1,color:"",fullscreen:!0,danmakuLimit:Object.keys(Ut)[0],isChinese:!0},t.random={count:100,timeRange:10},t.form={type:1,danmaku:"",videoSrc:""},t.debug=!1,t}return Dn(n,[{key:"sendDanmaku",value:function(){this.form.danmaku&&gn.sendDanmaku(new $t(this.form.danmaku,{type:Number(this.form.type),borderColor:"red",currentTime:gn.currentTime,id:"myself"}))}},{key:"formChanged",value:function(){var t=this.settings.isChinese?new _e:{volume:"Volume",live:"Live",play:"Play",pause:"Pause",copy:"Copy",danmakuSend:"Send",danmakuInputHint:"Input Danmaku Content",autoQualitySelect:"Auto",danmakuType:"Type",danmakuColor:"Color",danmakuTypeFlow:"Flow",danmakuTypeTopFixed:"Top",danmakuTypeBottomFixed:"Bottom",fullscreen:"Fullscreen",cancelFullscreen:"Cancel Fullscreen",showDanmaku:"Show Danmaku",hideDanmaku:"Hide Danmaku",loading:"Loading"};gn.set({color:this.settings.color,fullScreen:this.settings.fullscreen,danmakuForm:this.settings.danmakuForm,live:this.settings.live,volume:this.settings.volume,ui:t,danmaku:{alpha:this.settings.alpha,fadeoutDuration:this.settings.fadeoutDuration,flowDuration:this.settings.flowDuration,enable:this.settings.danmaku,limit:Ut[this.settings.danmakuLimit]}})}},{key:"formType",value:function(){}},{key:"debugSwitch",value:function(){var t=document.querySelector(".debug-info pre");this.debug?kn=setInterval((function(){t.innerText=JSON.stringify(gn.debug,null,2)}),100):(clearInterval(kn),t.innerText="")}},{key:"setSrc",value:function(){this.form.videoSrc&&gn.set({live:this.settings.live,src:this.form.videoSrc})}},{key:"playMp4",value:function(){gn.set({src:"https://file-examples.com/wp-content/uploads/2017/04/file_example_MP4_1280_10MG.mp4"})}},{key:"playMpd",value:function(){gn.set({src:"https://dash.akamaized.net/akamai/bbb_30fps/bbb_30fps.mpd"})}},{key:"playHls",value:function(){gn.set({src:"https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8",forceUse:pn.Hls})}},{key:"sendRandomDanmaku",value:function(){for(var t=[],e=0;e<this.random.count;e++){var n=Math.random()*this.random.timeRange,i=gn.currentTime+n,r=[0,1,2].indexOf(Math.round(3*Math.random())),o=new $t("弹幕 "+e,{currentTime:i,type:r});t.push(o)}gn.fillDanmakus(t)}},{key:"mounted",value:function(){var t=document.getElementById("player"),e=document.createElement("div");e.innerText="😂",e.onclick=function(){return alert("点击了扩展按钮")},t&&(gn=new xn(t,{src:"https://file-examples.com/wp-content/uploads/2017/04/file_example_MP4_1280_10MG.mp4",color:"#ea3bf1",width:"100%",volume:.7,timeFormat:"mm😊ss",danmakuForm:this.settings.danmakuForm,danmaku:{contextMenu:function(t){var e={};return"myself"===t.id?e["撤回"]=function(){alert("弹幕内容："+t.text)}:e["举报"]=function(){alert("举报内容："+t.text)},e}},beforeSendDanmaku:function(t){return Ln(s.a.mark((function e(){return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.id="myself",e.abrupt("return",!0);case 2:case"end":return e.stop()}}),e)})))()},extraButtons:[e]}),this.settings.flowDuration=gn.options.danmaku.flowDuration,this.settings.fadeoutDuration=gn.options.danmaku.fadeoutDuration,this.settings.alpha=gn.options.danmaku.alpha,this.settings.color=gn.options.color,this.settings.volume=gn.options.volume,this.settings.danmakuLimit=Object.keys(Ut)[Object.values(Ut).indexOf(gn.options.danmaku.limit)],window.player=gn)}},{key:"beforeDestroy",value:function(){gn.destroy(),clearInterval(kn)}}]),n}(u["b"]);Object(l["a"])([Object(u["c"])("settings",{deep:!0}),Object(l["b"])("design:type",Function),Object(l["b"])("design:paramtypes",[]),Object(l["b"])("design:returntype",void 0)],An.prototype,"formChanged",null),Object(l["a"])([Object(u["c"])("form.type"),Object(l["b"])("design:type",Function),Object(l["b"])("design:paramtypes",[]),Object(l["b"])("design:returntype",void 0)],An.prototype,"formType",null),Object(l["a"])([Object(u["c"])("debug"),Object(l["b"])("design:type",Function),Object(l["b"])("design:paramtypes",[]),Object(l["b"])("design:returntype",void 0)],An.prototype,"debugSwitch",null),An=Object(l["a"])([u["a"]],An);var Cn=An,Rn=Cn,qn=(n("5c0b"),n("2877")),zn=Object(qn["a"])(Rn,r,o,!1,null,null,null),Mn=zn.exports,Hn=n("5c96"),Un=n.n(Hn);n("0fae");i["default"].use(Un.a),i["default"].config.productionTip=!1,new i["default"]({render:function(t){return t(Mn)}}).$mount("#app")},cf05:function(t,e,n){t.exports=n.p+"img/logo.f68b23e0.png"},fdc2:function(t,e,n){var i=n("24fb");e=i(!1),e.push([t.i,".danplayer-danmaku-context-menu{position:absolute;font-size:12px;outline:none;color:#fff;padding:0 15px;z-index:999;background:rgba(0,0,0,.8)}.danplayer-danmaku-context-menu>div{height:42px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;cursor:default}.danplayer-danmaku-context-menu>div:hover .buttons{visibility:unset}.danplayer-danmaku-context-menu>div .content{padding-right:15px;width:135px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.danplayer-danmaku-context-menu>div .buttons{visibility:hidden}.danplayer-danmaku-context-menu>div .buttons span{border-radius:5px;padding:8px 10px;cursor:pointer}.danplayer-danmaku-context-menu>div .buttons span:hover{background:hsla(0,0%,100%,.1)}.danplayer{background:#000;position:relative;overflow:hidden;cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;outline:none}.danplayer .icon{width:1em;height:1em;vertical-align:-.15em;fill:currentColor;overflow:hidden}.danplayer.live .live-hide{display:none!important}.danplayer.mouse-idle,.danplayer.mouse-idle .danmaku-layer{cursor:none!important}.danplayer video.video-layer{background:#000;position:absolute;left:0;top:0;width:100%;height:100%;z-index:1}.danplayer div.interactive-layer{position:absolute;z-index:2;left:0;top:0;width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;text-align:center}.danplayer div.interactive-layer .toast{position:absolute;padding:6px;font-size:14px;background:#000;z-index:5;display:none;color:#fff;-webkit-box-shadow:0 0 5px rgba(0,0,0,.6);box-shadow:0 0 5px rgba(0,0,0,.6)}.danplayer div.interactive-layer .toast.show{display:block}.danplayer div.interactive-layer .float{background:rgba(21,21,21,.9);border-radius:2px;display:none;position:absolute;z-index:4}.danplayer div.interactive-layer .float.show{display:block}.danplayer div.interactive-layer .float.loading{padding:6px 10px;color:#fff}.danplayer div.interactive-layer .danmaku-style-layer{font-size:12px;padding:10px;color:#fff}.danplayer div.interactive-layer .danmaku-style-layer>div{margin-top:10px}.danplayer div.interactive-layer .danmaku-style-layer .types{display:-webkit-box;display:-ms-flexbox;display:flex}.danplayer div.interactive-layer .danmaku-style-layer .types .type{color:hsla(0,0%,100%,.5);cursor:pointer;margin:0 10px;text-align:center}.danplayer div.interactive-layer .danmaku-style-layer .types .type:hover{color:#fff}.danplayer div.interactive-layer .danmaku-style-layer .types .type>div{height:30px}.danplayer div.interactive-layer .danmaku-style-layer .types .type.selected{color:#00a1d6}.danplayer div.interactive-layer .danmaku-style-layer .types .type svg{width:40px;height:40px;padding-left:5px}.danplayer div.interactive-layer .danmaku-style-layer .types .type+.type{margin-left:8px}.danplayer div.interactive-layer .danmaku-style-layer .colors{margin-top:4px;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;width:240px}.danplayer div.interactive-layer .danmaku-style-layer .colors span{display:inline-block;width:20px;height:20px;cursor:pointer;border:2px solid transparent;border-radius:2px;margin:2px 5px}.danplayer div.interactive-layer .danmaku-style-layer .colors span:hover{border-color:#e7e7e7}.danplayer div.interactive-layer .danmaku-style-layer .colors span.selected{border-color:#00a1d6}.danplayer div.interactive-layer .volume-bar{width:32px;height:100px;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.danplayer div.interactive-layer .volume-bar .volume-num-label{color:#fff!important;text-align:center;font-size:12px;height:28px;line-height:28px;margin-bottom:2px}.danplayer div.interactive-layer .volume-bar .volume-column-bar{position:relative;width:100%;height:60px;cursor:pointer}.danplayer div.interactive-layer .volume-bar .volume-column-bar .bar-ui{width:2px;position:absolute;left:0;right:0;margin:0 auto}.danplayer div.interactive-layer .volume-bar .volume-column-bar .bar-ui.bar-full{height:100%;background:#e7e7e7;top:0}.danplayer div.interactive-layer .volume-bar .volume-column-bar .bar-ui.bar-current{background:#00a1d6;bottom:0}.danplayer div.interactive-layer .volume-bar .volume-column-bar .bar-controller{position:absolute;background:#00a1d6;border-radius:50%;width:12px;height:12px;left:0;right:0;top:-6px;margin:0 auto}.danplayer div.interactive-layer .quality-menu{font-size:14px;padding:5px}.danplayer div.interactive-layer .quality-menu>div{cursor:pointer;text-align:center;padding:2px 5px;color:#c3c3c3}.danplayer div.interactive-layer .quality-menu>div:hover{color:#fff}.danplayer div.interactive-layer .quality-menu>div.current{color:#00a1d6}.danplayer div.interactive-layer .quality-menu>div+>div{margin-top:5px}.danplayer div.interactive-layer .controller-bottom-bar{position:absolute;left:0;bottom:0;width:100%;z-index:3;-webkit-box-sizing:border-box;box-sizing:border-box}.danplayer div.interactive-layer .controller-bottom-bar.show{padding:0 20px 4px 20px}.danplayer div.interactive-layer .controller-bottom-bar.show .progress-bar{display:block;cursor:pointer;margin-bottom:10px;padding:4px 0 8px 0}.danplayer div.interactive-layer .controller-bottom-bar.show .progress-bar .bar-controller{display:block}.danplayer div.interactive-layer .controller-bottom-bar.show .buttons{display:-webkit-box;display:-ms-flexbox;display:flex}.danplayer div.interactive-layer .controller-bottom-bar .time{color:#fff;font-size:12px}.danplayer div.interactive-layer .controller-bottom-bar .progress-bar{position:relative;height:2px;cursor:pointer;display:block}.danplayer div.interactive-layer .controller-bottom-bar .progress-bar .bar-buffer,.danplayer div.interactive-layer .controller-bottom-bar .progress-bar .bar-current,.danplayer div.interactive-layer .controller-bottom-bar .progress-bar .bar-full{height:2px;position:absolute}.danplayer div.interactive-layer .controller-bottom-bar .progress-bar .bar-full{background:hsla(0,0%,100%,.2);z-index:1;width:100%}.danplayer div.interactive-layer .controller-bottom-bar .progress-bar .bar-buffer{background:hsla(0,0%,100%,.5);z-index:2}.danplayer div.interactive-layer .controller-bottom-bar .progress-bar .bar-current{background:#00a1d6;z-index:3}.danplayer div.interactive-layer .controller-bottom-bar .progress-bar .bar-controller{position:absolute;top:-1px;left:-6px;width:12px;height:12px;border-radius:2px;background:#00a1d6;z-index:4;display:none}.danplayer div.interactive-layer .controller-bottom-bar .buttons{display:none;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.danplayer div.interactive-layer .controller-bottom-bar .buttons>*{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.danplayer div.interactive-layer .controller-bottom-bar .buttons .right .button{margin-left:10px}.danplayer div.interactive-layer .controller-bottom-bar .buttons .button{color:hsla(0,0%,100%,.7);cursor:pointer;display:inline-block;font-size:12px}.danplayer div.interactive-layer .controller-bottom-bar .buttons .button:hover{color:#fff}.danplayer div.interactive-layer .controller-bottom-bar .buttons .button .icon{width:30px;height:30px}.danplayer div.interactive-layer .controller-bottom-bar .buttons .button.hide{display:none}.danplayer div.interactive-layer .controller-bottom-bar .buttons .button.danmaku-style{margin-top:4px}.danplayer div.interactive-layer .controller-bottom-bar .buttons .button.full-screen svg,.danplayer div.interactive-layer .controller-bottom-bar .buttons .button.picture-in-picture svg,.danplayer div.interactive-layer .controller-bottom-bar .buttons .button.volume svg{width:22px;height:22px}.danplayer div.interactive-layer .controller-bottom-bar .danmaku-form{border-radius:4px;background:hsla(0,0%,100%,.5);display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-flex:1;-ms-flex:1;flex:1;padding:0 4px;min-width:200px;max-width:350px;margin-right:20px;color:#fff}.danplayer div.interactive-layer .controller-bottom-bar .danmaku-form input{border:none;height:20px;outline:none;background:transparent;color:#fff;-webkit-box-flex:1;-ms-flex:1;flex:1}.danplayer div.interactive-layer .controller-bottom-bar .danmaku-form .send{color:#fff;border:none;font-size:12px;cursor:pointer;margin-left:10px}.danplayer div.interactive-layer .bg-gradient{position:absolute;bottom:0;left:0;width:100%;height:100px;background:-webkit-gradient(linear,left top,left bottom,from(transparent),to(rgba(0,0,0,.8)));background:linear-gradient(transparent,rgba(0,0,0,.8));opacity:0;-webkit-transition:opacity .2s ease-in-out;transition:opacity .2s ease-in-out;z-index:2}.danplayer div.interactive-layer .bg-gradient.show{opacity:1}.danplayer div.interactive-layer .danmaku-layer{position:absolute;left:0;top:0;z-index:1;cursor:pointer}",""]),t.exports=e}});
//# sourceMappingURL=app.836bfffe.js.map